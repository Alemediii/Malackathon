CREATE TABLE "DIEGO"."RAE_CMDB" 
   (	"NUM_REGISTRO_ANUAL" VARCHAR2(4000 BYTE) COLLATE "USING_NLS_COMP", 
	"CENTRO_RECODIFICADO" VARCHAR2(4000 BYTE) COLLATE "USING_NLS_COMP", 
	"CIP_SNS_RECODIFICADO" VARCHAR2(4000 BYTE) COLLATE "USING_NLS_COMP", 
	"CCAA" CHAR(2 BYTE) COLLATE "USING_NLS_COMP", 
	"COMUNIDAD_AUTONOMA" VARCHAR2(64 BYTE) COLLATE "USING_NLS_COMP", 
	"CCAA_RESIDENCIA" CHAR(2 BYTE) COLLATE "USING_NLS_COMP", 
	"PAIS_NACIMIENTO" CHAR(3 BYTE) COLLATE "USING_NLS_COMP", 
	"PAIS_RESIDENCIA" CHAR(3 BYTE) COLLATE "USING_NLS_COMP", 
	"FECHA_NACIMIENTO" DATE, 
	"SEXO" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"NOMBRE" VARCHAR2(200 BYTE) COLLATE "USING_NLS_COMP", 
	"FECHA_INICIO_CONTACTO" VARCHAR2(4000 BYTE) COLLATE "USING_NLS_COMP", 
	"FECHA_INGRESO" DATE, 
	"FECHA_FIN_CONTACTO" DATE, 
	"ESTANCIA_DIAS" NUMBER(3,0), 
	"CIRCUNSTANCIA_CONTACTO" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"TIPO_ALTA" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"REGIMEN_FINANCIACION" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDENCIA" CHAR(2 BYTE) COLLATE "USING_NLS_COMP", 
	"CONTINUIDAD_ASISTENCIAL" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"INGRESO_UCI" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAS_UCI" NUMBER(3,0), 
	"SERVICIO" VARCHAR2(3 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_PRINCIPAL" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"CATEGORIA" VARCHAR2(300 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_2" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_3" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_4" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_5" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_6" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_7" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_8" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_9" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_10" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_11" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_12" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_13" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_14" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_15" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_16" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_17" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_18" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_19" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"DIAGNOSTICO_20" CHAR(8 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_PRINCIPAL" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_2" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_3" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_4" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_5" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_6" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_7" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_8" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_9" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_10" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_11" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_12" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_13" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_14" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_15" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_16" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_17" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_18" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_19" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"POA_DIAG_20" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"FECHA_INTERVENCION" VARCHAR2(4000 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_1" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_2" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_3" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_4" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_5" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_6" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_7" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_8" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_9" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_10" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_11" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_12" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_13" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_14" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_15" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_16" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_17" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_18" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_19" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_20" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_EXTERNO_1" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_EXTERNO_2" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_EXTERNO_3" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_EXTERNO_4" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_EXTERNO_5" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"PROCEDIMIENTO_EXTERNO_6" CHAR(7 BYTE) COLLATE "USING_NLS_COMP", 
	"GRD_APR" VARCHAR2(3 BYTE) COLLATE "USING_NLS_COMP", 
	"CDM_APR" VARCHAR2(2 BYTE) COLLATE "USING_NLS_COMP", 
	"TIPO_GRD_APR" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"NIVEL_SEVERIDAD_APR" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"RIESGO_MORTALIDAD_APR" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"PESO_ESPANOL_APR" NUMBER, 
	"COSTE_APR" NUMBER(12,2), 
	"CIE" VARCHAR2(2 BYTE) COLLATE "USING_NLS_COMP", 
	"EDAD" NUMBER(3,0), 
	"EDAD_EN_INGRESO" NUMBER(3,0), 
	"REINGRESO" CHAR(1 BYTE) COLLATE "USING_NLS_COMP", 
	"MES_INGRESO" DATE
   )  DEFAULT COLLATION "USING_NLS_COMP" ;

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."CENTRO_RECODIFICADO" IS 'Hash SHA-256 (pepper + ID de centro normalizado)';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."CIP_SNS_RECODIFICADO" IS 'Hash SHA-256 (pepper + CIP normalizado)';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PAIS_NACIMIENTO" IS 'País de nacimiento (ISO alpha-3). FK a PAISES(ALPHA_3).';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PAIS_RESIDENCIA" IS 'País de residencia (ISO alpha-3). FK a PAISES(ALPHA_3).';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."SEXO" IS 'FK a SEXO(CODIGO).';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."NOMBRE" IS 'Seudónimo estable (no almacena el nombre real)';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."CIRCUNSTANCIA_CONTACTO" IS 'Código de circunstancia del contacto. FK a CIRCUNSTANCIA_DE_CONTACTO(CODIGO).';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."TIPO_ALTA" IS 'FK a TIPO_DE_ALTA(CODIGO).';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."REGIMEN_FINANCIACION" IS 'FK a REGIMEN_DE_FINANCIACION(CODIGO).';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDENCIA" IS 'FK a PROCEDENCIA(CODIGO).';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."CONTINUIDAD_ASISTENCIAL" IS 'Código de continuidad asistencial. FK a CONTINUIDAD_ASISTENCIAL(CODIGO).';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."INGRESO_UCI" IS 'FK a INGRESO_EN_UCI(CODIGO).';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."SERVICIO" IS 'FK a SERVICIOS(CODIGO).';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."DIAGNOSTICO_PRINCIPAL" IS 'Código CIE-10-ES del diagnóstico principal (FK DIAGNOSTICO)';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."DIAGNOSTICO_2" IS 'Código CIE-10-ES diagnóstico secundario #2 (FK DIAGNOSTICO)';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."DIAGNOSTICO_3" IS 'Código CIE-10-ES diagnóstico secundario #3 (FK DIAGNOSTICO)';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."POA_DIAG_PRINCIPAL" IS 'POA del diagnóstico principal. FK a POA_DIAGNOSTICO.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_1" IS 'PROC1 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_2" IS 'PROC2 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_3" IS 'PROC3 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_4" IS 'PROC4 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_5" IS 'PROC5 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_6" IS 'PROC6 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_7" IS 'PROC7 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_8" IS 'PROC8 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_9" IS 'PROC9 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_10" IS 'PROC10 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_11" IS 'PROC11 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_12" IS 'PROC12 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_13" IS 'PROC13 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_14" IS 'PROC14 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_15" IS 'PROC15 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_16" IS 'PROC16 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_17" IS 'PROC17 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_18" IS 'PROC18 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_19" IS 'PROC19 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_20" IS 'PROC20 CIE10-ES realizado en el centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_EXTERNO_1" IS 'PROCEXT1 CIE10-ES realizado en otro centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_EXTERNO_2" IS 'PROCEXT2 CIE10-ES realizado en otro centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_EXTERNO_3" IS 'PROCEXT3 CIE10-ES realizado en otro centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_EXTERNO_4" IS 'PROCEXT4 CIE10-ES realizado en otro centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_EXTERNO_5" IS 'PROCEXT5 CIE10-ES realizado en otro centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."PROCEDIMIENTO_EXTERNO_6" IS 'PROCEXT6 CIE10-ES realizado en otro centro.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."GRD_APR" IS 'FK a NIVELES_SEVERIDAD.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."CDM_APR" IS 'CDM APR.';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."TIPO_GRD_APR" IS 'Tipo de GRD APR-DRG (FK a TIPO_GRD_APR): Q=Quirúrgico / M=Médico';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."NIVEL_SEVERIDAD_APR" IS 'Nivel de severidad APR (1..4)';

COMMENT ON COLUMN "DIEGO"."RAE_CMDB"."RIESGO_MORTALIDAD_APR" IS 'Nivel de riesgo de mortalidad APR (1..4)';

CREATE UNIQUE INDEX "DIEGO"."RAE_CMDB_PK" ON "DIEGO"."RAE_CMDB" ("NUM_REGISTRO_ANUAL") 
  ;

ALTER TABLE "DIEGO"."RAE_CMDB" MODIFY ("NUM_REGISTRO_ANUAL" NOT NULL ENABLE NOVALIDATE);

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_CIRC_CONT" CHECK (CIRCUNSTANCIA_CONTACTO IN ('1','2','9')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_TIPO_ALTA" CHECK (TIPO_ALTA IN ('1','2','3','4','5','8','9')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_TIPO_GRD_APR" CHECK (TIPO_GRD_APR IN ('Q','M')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_SEVERIDAD_APR" CHECK (NIVEL_SEVERIDAD_APR IN ('1','2','3','4')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RIESGO_APR" CHECK (RIESGO_MORTALIDAD_APR IN ('1','2','3','4')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_1" CHECK (POA_DIAG_PRINCIPAL IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_2" CHECK (POA_DIAG_2 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_3" CHECK (POA_DIAG_3 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_4" CHECK (POA_DIAG_4 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_5" CHECK (POA_DIAG_5 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_6" CHECK (POA_DIAG_6 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_7" CHECK (POA_DIAG_7 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_8" CHECK (POA_DIAG_8 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_9" CHECK (POA_DIAG_9 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_10" CHECK (POA_DIAG_10 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_11" CHECK (POA_DIAG_11 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_12" CHECK (POA_DIAG_12 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_13" CHECK (POA_DIAG_13 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_14" CHECK (POA_DIAG_14 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_15" CHECK (POA_DIAG_15 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_16" CHECK (POA_DIAG_16 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_17" CHECK (POA_DIAG_17 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_18" CHECK (POA_DIAG_18 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_19" CHECK (POA_DIAG_19 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_POA_20" CHECK (POA_DIAG_20 IN ('S','N','D','I','E')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_CCAA_FORMAT" CHECK (CCAA IS NULL OR REGEXP_LIKE(CCAA, '^[0-9]{2}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_CCAA_RES_FORMAT" CHECK (CCAA_RESIDENCIA IS NULL OR REGEXP_LIKE(CCAA_RESIDENCIA, '^[0-9]{2}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_1_FMT" CHECK (PROCEDIMIENTO_1 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_1,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_2_FMT" CHECK (PROCEDIMIENTO_2 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_2,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_3_FMT" CHECK (PROCEDIMIENTO_3 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_3,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_4_FMT" CHECK (PROCEDIMIENTO_4 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_4,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_5_FMT" CHECK (PROCEDIMIENTO_5 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_5,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_6_FMT" CHECK (PROCEDIMIENTO_6 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_6,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_7_FMT" CHECK (PROCEDIMIENTO_7 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_7,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_8_FMT" CHECK (PROCEDIMIENTO_8 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_8,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_9_FMT" CHECK (PROCEDIMIENTO_9 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_9,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_10_FMT" CHECK (PROCEDIMIENTO_10 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_10,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_11_FMT" CHECK (PROCEDIMIENTO_11 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_11,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_12_FMT" CHECK (PROCEDIMIENTO_12 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_12,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_13_FMT" CHECK (PROCEDIMIENTO_13 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_13,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_14_FMT" CHECK (PROCEDIMIENTO_14 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_14,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_15_FMT" CHECK (PROCEDIMIENTO_15 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_15,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_16_FMT" CHECK (PROCEDIMIENTO_16 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_16,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_17_FMT" CHECK (PROCEDIMIENTO_17 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_17,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_18_FMT" CHECK (PROCEDIMIENTO_18 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_18,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_19_FMT" CHECK (PROCEDIMIENTO_19 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_19,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_20_FMT" CHECK (PROCEDIMIENTO_20 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_20,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_EXT_1_FMT" CHECK (PROCEDIMIENTO_EXTERNO_1 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_EXTERNO_1,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_EXT_2_FMT" CHECK (PROCEDIMIENTO_EXTERNO_2 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_EXTERNO_2,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_EXT_3_FMT" CHECK (PROCEDIMIENTO_EXTERNO_3 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_EXTERNO_3,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_EXT_4_FMT" CHECK (PROCEDIMIENTO_EXTERNO_4 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_EXTERNO_4,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_EXT_5_FMT" CHECK (PROCEDIMIENTO_EXTERNO_5 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_EXTERNO_5,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_PROC_EXT_6_FMT" CHECK (PROCEDIMIENTO_EXTERNO_6 IS NULL OR REGEXP_LIKE(PROCEDIMIENTO_EXTERNO_6,'^[0-9A-Z]{7}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_UCI_DIAS_CK" CHECK (
    /* No ingreso -> días null o 0 */
    (ingreso_uci IN ('N','0') AND (dias_uci IS NULL OR dias_uci = 0))
    OR
    /* Sí ingreso -> días >=1 */
    (ingreso_uci IN ('S','1') AND dias_uci >= 1)
    OR
    /* Caso indeterminado -> sin restricción sobre días */
    (ingreso_uci NOT IN ('S','N','1','0') OR ingreso_uci IS NULL)
  ) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_APR_CK" CHECK (tipo_grd_apr IN ('Q','M') AND nivel_severidad_apr BETWEEN '1' AND '4') ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG1_FMT" CHECK (
    DIAGNOSTICO_PRINCIPAL IS NULL
    OR REGEXP_LIKE( UPPER(TRIM(DIAGNOSTICO_PRINCIPAL)),
                    '^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$' )
  ) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_CONTINUIDAD_ASISTENCIAL" CHECK (CONTINUIDAD_ASISTENCIAL IN ('1','2','3','4','5','6','8','9')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PK" PRIMARY KEY ("NUM_REGISTRO_ANUAL")
  USING INDEX "DIEGO"."RAE_CMDB_PK"  ENABLE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_SEXO" CHECK (SEXO IN ('1','2','9')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_REGFIN" CHECK (REGIMEN_FINANCIACION IN ('1','2','3','4','5','6','7','8','9')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_NIVEL_SEVERIDAD_APR" CHECK (NIVEL_SEVERIDAD_APR IS NULL OR NIVEL_SEVERIDAD_APR IN ('1','2','3','4')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_RIESGO_MORTALIDAD_APR" CHECK (RIESGO_MORTALIDAD_APR IS NULL OR RIESGO_MORTALIDAD_APR IN ('1','2','3','4')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_CIP_HASH" CHECK (CIP_SNS_RECODIFICADO IS NULL OR REGEXP_LIKE(CIP_SNS_RECODIFICADO, '^[0-9A-F]{64}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_CENTRO_HASH" CHECK (CENTRO_RECODIFICADO IS NULL OR REGEXP_LIKE(CENTRO_RECODIFICADO, '^[0-9A-F]{64}$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_INGRESO_UCI" CHECK (INGRESO_UCI IN ('1','2')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_PROCEDENCIA_BOE" CHECK (
    PROCEDENCIA IS NULL OR REGEXP_LIKE(PROCEDENCIA,
      '^(10|21|22|23|24|25|26|27|28|30|40|50|60|70|80|90)$')
  ) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG2_FMT" CHECK (DIAGNOSTICO_2  IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_2)),
        '^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG3_FMT" CHECK (DIAGNOSTICO_3  IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_3)),
        '^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG4_FMT" CHECK (DIAGNOSTICO_4  IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_4)),  '^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG5_FMT" CHECK (DIAGNOSTICO_5  IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_5)),  '^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG6_FMT" CHECK (DIAGNOSTICO_6  IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_6)),  '^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG7_FMT" CHECK (DIAGNOSTICO_7  IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_7)),  '^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG8_FMT" CHECK (DIAGNOSTICO_8  IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_8)),  '^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG9_FMT" CHECK (DIAGNOSTICO_9  IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_9)),  '^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG10_FMT" CHECK (DIAGNOSTICO_10 IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_10)),'^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG11_FMT" CHECK (DIAGNOSTICO_11 IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_11)),'^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG12_FMT" CHECK (DIAGNOSTICO_12 IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_12)),'^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG13_FMT" CHECK (DIAGNOSTICO_13 IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_13)),'^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG14_FMT" CHECK (DIAGNOSTICO_14 IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_14)),'^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG15_FMT" CHECK (DIAGNOSTICO_15 IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_15)),'^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG16_FMT" CHECK (DIAGNOSTICO_16 IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_16)),'^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG17_FMT" CHECK (DIAGNOSTICO_17 IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_17)),'^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG18_FMT" CHECK (DIAGNOSTICO_18 IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_18)),'^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG19_FMT" CHECK (DIAGNOSTICO_19 IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_19)),'^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_DIAG20_FMT" CHECK (DIAGNOSTICO_20 IS NULL OR REGEXP_LIKE(UPPER(TRIM(DIAGNOSTICO_20)),'^[A-Z][0-9A-Z]{2}(\.[0-9A-Z]{1,3})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_FECINICONT_FMT" CHECK (FECHA_INICIO_CONTACTO IS NULL OR
         REGEXP_LIKE(FECHA_INICIO_CONTACTO,
         '^[0-9]{2}/[0-9]{2}/[0-9]{4}( [0-9]{2}:[0-9]{2})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_FECINT_FMT" CHECK (FECHA_INTERVENCION IS NULL OR
         REGEXP_LIKE(FECHA_INTERVENCION,
         '^[0-9]{2}/[0-9]{2}/[0-9]{4}( [0-9]{2}:[0-9]{2})?$')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_FECHAS_ORDEN" CHECK (FECHA_FIN_CONTACTO IS NULL OR
         FECHA_INGRESO IS NULL OR
         FECHA_FIN_CONTACTO >= FECHA_INGRESO) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_UCI_LE_ESTANCIA" CHECK (DIAS_UCI IS NULL OR ESTANCIA_DIAS IS NULL OR DIAS_UCI <= ESTANCIA_DIAS) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_MES_INGRESO_MATCH" CHECK (MES_INGRESO IS NULL OR FECHA_INGRESO IS NULL
         OR TRUNC(MES_INGRESO,'MM') = TRUNC(FECHA_INGRESO,'MM')) ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "CK_RAE_EDAD_RANGO" CHECK ((EDAD IS NULL OR (EDAD BETWEEN 0 AND 120))
     AND (EDAD_EN_INGRESO IS NULL OR (EDAD_EN_INGRESO BETWEEN 0 AND 120))) ENABLE NOVALIDATE;

GRANT DELETE ON "DIEGO"."RAE_CMDB" TO "ADMIN";

GRANT INSERT ON "DIEGO"."RAE_CMDB" TO "ADMIN";

GRANT SELECT ON "DIEGO"."RAE_CMDB" TO "ADMIN";

GRANT UPDATE ON "DIEGO"."RAE_CMDB" TO "ADMIN";

GRANT READ ON "DIEGO"."RAE_CMDB" TO "MALACKATHON";

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_CCAA_FK" FOREIGN KEY ("CCAA")
	  REFERENCES "DIEGO"."CCAA" ("CODAUTO") ON DELETE SET NULL ENABLE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_CCAA_RES_FK" FOREIGN KEY ("CCAA_RESIDENCIA")
	  REFERENCES "DIEGO"."CCAA" ("CODAUTO") ON DELETE SET NULL ENABLE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_P_FK" FOREIGN KEY ("DIAGNOSTICO_PRINCIPAL")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_2_FK" FOREIGN KEY ("DIAGNOSTICO_2")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_3_FK" FOREIGN KEY ("DIAGNOSTICO_3")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_4_FK" FOREIGN KEY ("DIAGNOSTICO_4")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_5_FK" FOREIGN KEY ("DIAGNOSTICO_5")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_6_FK" FOREIGN KEY ("DIAGNOSTICO_6")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_7_FK" FOREIGN KEY ("DIAGNOSTICO_7")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_8_FK" FOREIGN KEY ("DIAGNOSTICO_8")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_9_FK" FOREIGN KEY ("DIAGNOSTICO_9")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_10_FK" FOREIGN KEY ("DIAGNOSTICO_10")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_11_FK" FOREIGN KEY ("DIAGNOSTICO_11")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_12_FK" FOREIGN KEY ("DIAGNOSTICO_12")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_13_FK" FOREIGN KEY ("DIAGNOSTICO_13")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_14_FK" FOREIGN KEY ("DIAGNOSTICO_14")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_15_FK" FOREIGN KEY ("DIAGNOSTICO_15")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_16_FK" FOREIGN KEY ("DIAGNOSTICO_16")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_17_FK" FOREIGN KEY ("DIAGNOSTICO_17")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_18_FK" FOREIGN KEY ("DIAGNOSTICO_18")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_19_FK" FOREIGN KEY ("DIAGNOSTICO_19")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_DIAG_20_FK" FOREIGN KEY ("DIAGNOSTICO_20")
	  REFERENCES "DIEGO"."DIAGNOSTICO" ("CODIGO") ON DELETE SET NULL ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC1_FK" FOREIGN KEY ("PROCEDIMIENTO_1")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC2_FK" FOREIGN KEY ("PROCEDIMIENTO_2")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC3_FK" FOREIGN KEY ("PROCEDIMIENTO_3")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC4_FK" FOREIGN KEY ("PROCEDIMIENTO_4")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC5_FK" FOREIGN KEY ("PROCEDIMIENTO_5")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC6_FK" FOREIGN KEY ("PROCEDIMIENTO_6")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC7_FK" FOREIGN KEY ("PROCEDIMIENTO_7")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC8_FK" FOREIGN KEY ("PROCEDIMIENTO_8")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC9_FK" FOREIGN KEY ("PROCEDIMIENTO_9")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC10_FK" FOREIGN KEY ("PROCEDIMIENTO_10")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC11_FK" FOREIGN KEY ("PROCEDIMIENTO_11")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC12_FK" FOREIGN KEY ("PROCEDIMIENTO_12")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC13_FK" FOREIGN KEY ("PROCEDIMIENTO_13")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC14_FK" FOREIGN KEY ("PROCEDIMIENTO_14")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC15_FK" FOREIGN KEY ("PROCEDIMIENTO_15")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC16_FK" FOREIGN KEY ("PROCEDIMIENTO_16")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC17_FK" FOREIGN KEY ("PROCEDIMIENTO_17")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC18_FK" FOREIGN KEY ("PROCEDIMIENTO_18")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC19_FK" FOREIGN KEY ("PROCEDIMIENTO_19")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROC20_FK" FOREIGN KEY ("PROCEDIMIENTO_20")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROCEXT1_FK" FOREIGN KEY ("PROCEDIMIENTO_EXTERNO_1")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROCEXT2_FK" FOREIGN KEY ("PROCEDIMIENTO_EXTERNO_2")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROCEXT3_FK" FOREIGN KEY ("PROCEDIMIENTO_EXTERNO_3")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROCEXT4_FK" FOREIGN KEY ("PROCEDIMIENTO_EXTERNO_4")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROCEXT5_FK" FOREIGN KEY ("PROCEDIMIENTO_EXTERNO_5")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROCEXT6_FK" FOREIGN KEY ("PROCEDIMIENTO_EXTERNO_6")
	  REFERENCES "DIEGO"."PROCEDIMIENTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_CIRCUNST_FK" FOREIGN KEY ("CIRCUNSTANCIA_CONTACTO")
	  REFERENCES "DIEGO"."CIRCUNSTANCIA_DE_CONTACTO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_CA_FK" FOREIGN KEY ("CONTINUIDAD_ASISTENCIAL")
	  REFERENCES "DIEGO"."CONTINUIDAD_ASISTENCIAL" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_UCI_FK" FOREIGN KEY ("INGRESO_UCI")
	  REFERENCES "DIEGO"."INGRESO_EN_UCI" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PAIS_NAC_FK" FOREIGN KEY ("PAIS_NACIMIENTO")
	  REFERENCES "DIEGO"."PAISES" ("COUNTRY_CODE") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PAIS_RES_FK" FOREIGN KEY ("PAIS_RESIDENCIA")
	  REFERENCES "DIEGO"."PAISES" ("COUNTRY_CODE") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_PRI_FK" FOREIGN KEY ("POA_DIAG_PRINCIPAL")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_2_FK" FOREIGN KEY ("POA_DIAG_2")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_3_FK" FOREIGN KEY ("POA_DIAG_3")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_4_FK" FOREIGN KEY ("POA_DIAG_4")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_5_FK" FOREIGN KEY ("POA_DIAG_5")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_6_FK" FOREIGN KEY ("POA_DIAG_6")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_7_FK" FOREIGN KEY ("POA_DIAG_7")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_8_FK" FOREIGN KEY ("POA_DIAG_8")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_9_FK" FOREIGN KEY ("POA_DIAG_9")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_10_FK" FOREIGN KEY ("POA_DIAG_10")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_11_FK" FOREIGN KEY ("POA_DIAG_11")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_12_FK" FOREIGN KEY ("POA_DIAG_12")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_13_FK" FOREIGN KEY ("POA_DIAG_13")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_14_FK" FOREIGN KEY ("POA_DIAG_14")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_15_FK" FOREIGN KEY ("POA_DIAG_15")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_16_FK" FOREIGN KEY ("POA_DIAG_16")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_17_FK" FOREIGN KEY ("POA_DIAG_17")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_18_FK" FOREIGN KEY ("POA_DIAG_18")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_19_FK" FOREIGN KEY ("POA_DIAG_19")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_POA_20_FK" FOREIGN KEY ("POA_DIAG_20")
	  REFERENCES "DIEGO"."POA_DIAGNOSTICO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_PROCEDENCIA_FK" FOREIGN KEY ("PROCEDENCIA")
	  REFERENCES "DIEGO"."PROCEDENCIA" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_REGFIN_FK" FOREIGN KEY ("REGIMEN_FINANCIACION")
	  REFERENCES "DIEGO"."REGIMEN_DE_FINANCIACION" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_SERVICIO_FK" FOREIGN KEY ("SERVICIO")
	  REFERENCES "DIEGO"."SERVICIOS" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_SEXO_FK" FOREIGN KEY ("SEXO")
	  REFERENCES "DIEGO"."SEXO" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_TIPO_ALTA_FK" FOREIGN KEY ("TIPO_ALTA")
	  REFERENCES "DIEGO"."TIPO_DE_ALTA" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_TIPO_GRD_APR_FK" FOREIGN KEY ("TIPO_GRD_APR")
	  REFERENCES "DIEGO"."TIPO_GRD_APR" ("CODIGO") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_GRD_PARAM_FK" FOREIGN KEY ("GRD_APR", "NIVEL_SEVERIDAD_APR", "TIPO_GRD_APR", "CDM_APR")
	  REFERENCES "DIEGO"."GRD_APR_TIPO_GRD_CDM_APR" ("GRD_APR_STR", "SEVERIDAD_CHAR", "TIPO_GRD_APR", "CDM_CHAR") ENABLE NOVALIDATE;

ALTER TABLE "DIEGO"."RAE_CMDB" ADD CONSTRAINT "RAE_CMDB_CENTRO_FK" FOREIGN KEY ("CENTRO_RECODIFICADO")
	  REFERENCES "DIEGO"."HOSPITALES" ("CCN") ENABLE NOVALIDATE;

--CREATE OR REPLACE SYNONYM ADMIN.RAE_CMDB FOR DIEGO.RAE_CMDB;

CREATE OR REPLACE EDITIONABLE TRIGGER "DIEGO"."RAE_CMDB_ANON_BIU" 
BEFORE INSERT OR UPDATE ON DIEGO.RAE_CMDB
FOR EACH ROW
BEGIN
  -- CIP y Centro -> hash determinístico
  :NEW.CIP_SNS_RECODIFICADO  := DIEGO.ANON.token_cip(:NEW.CIP_SNS_RECODIFICADO);
  :NEW.CENTRO_RECODIFICADO   := DIEGO.ANON.token_centro(:NEW.CENTRO_RECODIFICADO);

  -- Nombre -> seudónimo (si viene nulo, lo dejamos nulo)
  IF :NEW.NOMBRE IS NOT NULL THEN
    :NEW.NOMBRE := DIEGO.ANON.seudonimo_nombre(:NEW.NOMBRE);
  END IF;
END;

/
ALTER TRIGGER "DIEGO"."RAE_CMDB_ANON_BIU" ENABLE;

CREATE OR REPLACE EDITIONABLE TRIGGER "DIEGO"."RAE_CMDB_ANON_BIU_NAC" 
BEFORE INSERT OR UPDATE OF FECHA_NACIMIENTO ON DIEGO.RAE_CMDB
FOR EACH ROW
FOLLOWS DIEGO.RAE_CMDB_ANON_BIU
BEGIN
  :NEW.FECHA_NACIMIENTO := DIEGO.ANON_DATE.anon_fecha_nacimiento(
                              :NEW.FECHA_NACIMIENTO,
                              :NEW.CIP_SNS_RECODIFICADO);
END;

/
ALTER TRIGGER "DIEGO"."RAE_CMDB_ANON_BIU_NAC" ENABLE;

